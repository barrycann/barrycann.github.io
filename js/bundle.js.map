{"version":3,"sources":["app.js","dailyDirective.js","footer.js","mainWeatherDir.js","navDirective.js","weatherCtrl.js","weatherService.js"],"names":["angular","module","config","$stateProvider","$urlRouterProvider","state","url","templateUrl","otherwise","directive","restrict","controller","$scope","weatherService","getLocation","then","data","loc","getWeather","lat","lon","getForecast","city","a","b","weather","image","currentTemp","wind","humidity","humid","forecast","console","log","service","$http","$q","def","defer","get","response","parsed","resolve","promise","resp","desc","description","toFahren","main","temp","windToMph","speed","getImage","list","date","buildDateArray","tempK","Math","round","arr","fiveDay","temps","time","i","length","dt_txt","substr","push","windAvg","reduce","humidAvg","dailyDesc","findWeather","day","DailyInfo","moment","format","max","min","trimmed","splice","dayOfWeek","high","low","clearCount","cloudCount","theImage"],"mappings":"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","file":"bundle.js","sourcesContent":["angular.module('weatherApp', ['ui.router'])\r\n.config(function ($stateProvider, $urlRouterProvider){\r\n    $stateProvider\r\n        .state( 'home', {\r\n            url: '/',\r\n            templateUrl: '../views/homeTmpl.html'\r\n        })\r\n        .state( 'fiveDay', {\r\n            url: '/fiveDayForecast',\r\n            templateUrl: '../views/fiveDayTmpl.html'\r\n        })\r\n        .state( 'data', {\r\n            url: '/data',\r\n            templateUrl: '../views/data.html'\r\n        });\r\n    \r\n    $urlRouterProvider\r\n        .otherwise('/');\r\n});","angular.module('weatherApp')\r\n.directive('dailyDir', function(){\r\n   return {\r\n      restrict: 'E',\r\n      templateUrl: './views/dailyTmpl.html',\r\n      controller: function($scope){\r\n         \r\n      }\r\n   }\r\n})","angular.module('weatherApp')\r\n.directive('footerDir', function(){\r\n   return {\r\n      restrict: 'E',\r\n      templateUrl: './views/footerTmpl.html'\r\n   }\r\n});","angular.module('weatherApp')\r\n.directive('mainWeatherDir', function(){\r\n   return {\r\n      restrict: 'E',\r\n      templateUrl: './views/weatherTmpl.html',\r\n   }\r\n});","angular.module('weatherApp')\r\n.directive('navDir', function(){\r\n   return {\r\n      restrict: 'AE',\r\n      templateUrl: './views/navTmpl.html',\r\n   }\r\n});","angular.module('weatherApp')\r\n.controller('weatherCtrl', function($scope, weatherService){\r\n\r\n    $scope.getLocation = function(){\r\n        weatherService.getLocation()\r\n        .then(function(data){\r\n            $scope.loc = data;\r\n            $scope.getWeather(data.lat, data.lon);\r\n            $scope.getForecast(data.city);\r\n        });\r\n    }\r\n\r\n    $scope.getWeather = function(a, b){\r\n        weatherService.getWeather(a, b)\r\n        .then(function(data){\r\n            $scope.weather = data;\r\n            $scope.image = $scope.weather.image;\r\n            $scope.currentTemp = $scope.weather.currentTemp;\r\n            $scope.wind = $scope.weather.wind;\r\n            $scope.humidity = $scope.weather.humid;\r\n        });\r\n    }\r\n\r\n    $scope.getForecast = function(city){\r\n        weatherService.getForecast(city)\r\n        .then(function(data){\r\n            $scope.forecast = data;\r\n            console.log($scope.forecast);\r\n        });\r\n    }\r\n\r\n    $scope.getLocation();\r\n});","angular.module('weatherApp')\r\n.service('weatherService', function($http, $q){\r\n    \r\n    this.getLocation = function(){\r\n        var def = $q.defer();\r\n        $http.get('http://ip-api.com/json')\r\n        .then(function(response){\r\n            var parsed = response.data;\r\n            def.resolve(parsed);\r\n        });\r\n        return def.promise;\r\n    }\r\n\r\n    this.getWeather = function(lat, lon){\r\n        var def = $q.defer();\r\n        $http.get('http://api.openweathermap.org/data/2.5/weather?lat=' + lat + '&lon=' + lon + '&appid=48a8f7e3f9111f2ae148e9d7d078c129')\r\n        .then(function(resp){\r\n            var desc = resp.data.weather[0].description;\r\n            var weather = {\r\n                desc: desc,\r\n                currentTemp: toFahren(resp.data.main.temp),\r\n                wind: windToMph(resp.data.wind.speed),\r\n                humid: resp.data.main.humidity,\r\n                image: getImage(desc)\r\n            }\r\n            def.resolve(weather);\r\n        });\r\n        return def.promise;\r\n    }\r\n\r\n    this.getForecast = function(city){\r\n        var def = $q.defer();\r\n        $http.get('http://api.openweathermap.org/data/2.5/forecast?q='+city+',us&appid=48a8f7e3f9111f2ae148e9d7d078c129')\r\n        .then(function(resp){\r\n            var parsed = resp.data.list;\r\n            var date = buildDateArray(parsed);\r\n            def.resolve(date);\r\n        });\r\n        return def.promise;\r\n    }\r\n\r\n    function toFahren(tempK){\r\n        return Math.round(((tempK * 1.8) - 459));\r\n    }\r\n\r\n    // Converts speed in meters/second to miles/hour\r\n    function windToMph(speed){\r\n        return Math.round((speed * 2.23694) * 10) / 10;\r\n    }\r\n\r\n    // Takes info from weather forecast object and puts it into an array of daily forecast objects\r\n    function buildDateArray(arr){\r\n        var fiveDay = [];\r\n        var date = '';\r\n        var image = '';\r\n        var temps = [];\r\n        var wind = [];\r\n        var humid = [];\r\n        var desc = [];\r\n        var time = 0;\r\n        \r\n        for(var i=0;i<arr.length;i++){\r\n            date = arr[i].dt_txt.substr(0, 10);\r\n            time = arr[i].dt_txt.substr(11, 2);\r\n            temps.push(toFahren(arr[i].main.temp));\r\n            wind.push(arr[i].wind.speed);\r\n            humid.push(arr[i].main.humidity);\r\n            desc.push(arr[i].weather[0].description);\r\n            if(time == '21' || i == arr.length-1){\r\n                var windAvg = windToMph((wind.reduce(function(a,b){ return a+b;}))/wind.length);\r\n                var humidAvg = (humid.reduce(function(a,b){return a+b;})/humid.length);\r\n                var dailyDesc = findWeather(desc);\r\n                console.log(desc);\r\n                var day = new DailyInfo(\r\n                    moment(date).format('MMM D'),\r\n                    moment(date).format('ddd'), \r\n                    Math.max(...temps),\r\n                    Math.min(...temps),\r\n                    windAvg,\r\n                    Math.round(humidAvg),\r\n                    getImage(dailyDesc)\r\n                );\r\n                \r\n                fiveDay.push(day);\r\n                \r\n                date = '';\r\n                temps = [];\r\n                wind = [];\r\n                humid = [];\r\n                desc = [];\r\n            }\r\n        }\r\n\r\n        // Checks to see if today's info got into the five day, and removes today (which would be a six day forecast)\r\n        if(fiveDay.length > 5){\r\n            trimmed = fiveDay.splice(1);\r\n            return trimmed;\r\n        }\r\n        return fiveDay;\r\n    }\r\n\r\n    // Daily forecast info constructor\r\n    function DailyInfo(date, dayOfWeek, high, low, wind, humid, desc){\r\n        this.date = date;\r\n        this.dayOfWeek = dayOfWeek;\r\n        this.high = high;\r\n        this.low = low;\r\n        this.wind = wind;\r\n        this.humid = humid;\r\n        this.desc = desc;\r\n    }\r\n\r\n    function findWeather(arr){\r\n        var clearCount = 0;\r\n        var cloudCount = 0;\r\n        for(var i=0;i<arr.length;i++){\r\n            if(arr[i] == 'light rain' || arr[i] == 'rain'){\r\n                return 'rain';\r\n            }\r\n            if(arr[i] == 'clear sky'){\r\n                clearCount ++;\r\n            }\r\n            if(arr[i] == 'broken clouds'){\r\n                cloudCount++;\r\n            }\r\n        }\r\n        if(clearCount > (arr.length / 2)){\r\n            return 'clear sky';\r\n        }\r\n        if(cloudCount >= 2){\r\n            return 'broken clouds';\r\n        }\r\n        return arr[arr.length-1];\r\n    }\r\n\r\n    function getImage(desc){\r\n        var theImage = '';\r\n        switch(desc) {\r\n            case 'clear sky':\r\n                theImage = './img/clearSky.jpg';\r\n                break;\r\n            case 'few clouds':\r\n            case 'scattered clouds':\r\n                theImage = './img/PartlyCloudy.jpg';\r\n                break;\r\n            case 'broken clouds':\r\n                theImage = './img/cloudy.jpg';\r\n                break;\r\n            case 'rain':\r\n            case 'shower rain':\r\n            case 'thunderstorm':\r\n                theImage = './img/Rain.jpg';\r\n                break;\r\n            case 'snow':\r\n            case 'mist':\r\n                theImage = './img/heavySnow.jpg';\r\n                break;\r\n            default:\r\n                theImage='./img/PartlyCloudy.jpg';\r\n        }\r\n        return theImage;\r\n    }\r\n});"]}